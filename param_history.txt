1/22/16: Tried just doing negative with classical female strategy. No Monogamy
1/22/16: Tried boosting the shift scaler to .3, still seems like it's not hitting equilibrium. 
1/22/16: Tried running for 3000, still not hitting equilibrium, noticed that males aren't changing at all in 3000 turns. That's probably wrong. Something is weird with the reward matrix...
-not exactly weird, it's that the females are so crowded no one is reproducing, so there's no reward that any of the males can see, so they can't respond to the rewards. Turns out there was a bug in adjacency update function
1/22/19: Males focus on a signle female, but many end up on the same female. females are only getting negative benefits...it actually seems like there is a bias towards sharing females. As before, it seems like females are not reaching equilibrium, although males reach it rapidly. 
1/22/19: Fixed some bugs and now it seems like the program runs as expected, but same basic behavior of males focussing on a couple females. There's a broader problem in that males have no way to ease off (which would benefit both them and the female) But the females should be responding more strategically.
1/22/19: INTERESTING: If females have enough resources that they can outrun all males, monogamy starts to shake out better. Now females also need a way to ease off investment to commit more into foraging, but this seems to indicate that if females can't evade males, there's no punishment/reward they can offer. That said, we're still not seeing monogamy, and there still seems to be some bias for already busy females. But I think my strategy is wrong here. Males need an optimization strategy that doesn't require them to invest all their resources. Females could probably have a similar strategy.
1/22/19: Assuming the code works, I set up a little optimization function. I'll need to check to make sure it's running properly, but it seems to not collectively coverge on the best solution. I think females need to take a more active hand (rather than exploring, deliberately invest certain males or something. Oh! maybe they just need to invest less (remember, investment is fleeing)
-Nope, that's not it, the optimization method deals with that. 
-The problem also does not go away by removing randomization (in fact that ruins it, since they never start moving) 
-It seems to be that the change in reward is much more influenced by what everyone else does than by what they individually do. This too could probably be resolved by looking at change in adjacency (which is individually determined)
1/22/19 - Setting it to adjacency doesn't fix it. It seems like it's just too big of a space for a naive optimization to not get stuck in local optima..
- It still seems like it might work if females take an active hand.
1/28/19 - I tried it with just two birds. Here we do get monogamy shaking out some of the time. It's clear there is some problem. It seems like both males and females should be able to ease off, but they don't. 
1/28/19 - Things actually get better when females do nothing. With no fleeing it allows males to hash it out amongst themselves and get to decent equilibria. It's not great though. 
1/28/19 - It's really a problem of perverse incentives: Everyone would be best served by each male courting a single female, minimally. However, in such a scenario, males can increase their success by investing more than the other male. But what if females just blocked one male completely? Or rewarded the lowest investing male? Lets start with them just picking their number.
1/28/19 - This sort of works. But there are challenges: males when they get 0 reward always, don't have a good way to optimize to 0. I guess their reward needs some nominal value for their investment? 
1/28/19 - I added a factor to subtract investment (*.1) from the reward, which should incentivize decreasing investment where they're getting no reward...there's a minor bug that females get benefits from investment even when they run away constantly. Also, it doesn't count the cost of running away, which is a bit silly. But what's the bigger problem? ? ? 
1/28/19 - There was a bug, which was making it impossible for them to optimize (in short, I was accidentally setting the previous investment equal to the current investment, so there was never a gradiant.) Now there is a new bug, where males aren't getting any rewards...or rather they're not getting any adjacency
1/28/19 - Quite a bit of debugging, I think it should work now, will test tomorrow.
1/29/19 - Still debugging, when I changed the update_invest strategy, it was resetting the current invest each time.
1/29/19 - There are two problems I see: The first is just a bug, males are getting rewards from females even if they have 0 adjacency. That's important to fix. The second is more tricky. Female out put goes up as males invest less, so unless there is a nicely tuned dampening, males will always end up at zero, and then just occasionally randomly invest a little bit. It thus needs to be tuned such that they randomly hang out near zero, but because decreasing/increasing provides such tiny benefits it goes to zero. OR I could set the female reward function sucht that they need some minimum amount of adjacency or it goes down. Like maybe it takes .1 investment. Or it could be the conbination of two functions: Prob(offspring) * Prob(offspring survival). More specifically: Prob(egg) * Prob(finding a nest & survival). I could also make this more realistic, where Prob(offspring survival) remains quite low, and see if that changes anything.  
1/29/19 - Fixed more bugs (the cost of investment on reward was causing some weird stuff), and now males are monogamous, but they're investing waay too much. Their reward should increase when they invest less, but that's not happening for some reason. Their reward is tracking really closely to their investment. It seems like this could either be because they're making random changes at the same time (which would be bad) or because theirs some issue in the adjacency to reward function...or maybe reward is stuck at 0?
1/29/19 - I checked and random wasn't a problem, but there was an issue with the reward function which I fixed. While I was there, I added a reproduction component to the success function, so now they have very low success at very low investment (0 success at 0) and maximum success around .1. Now the issue is the optimization strategy. Males need some dampening or something, they tend to overshoot, hit zero, and then get stuck oscillating between 0 and 1. This is actually better than previous strategies I would bet, and total benefit is probbly finally positive for both males and females, but I think I can tweak the male strategy a bit to help them find the optimal investment. Also, there's a little bug in the reward function where females are getting a bit of reward from males that they're getting nothing from.
- Actually, I need to think a little harder about the reward. It seems like search cost should be based on investment while reward should be based on adjacency (assuming it costs equal time whether she runs or gets courted by a male)
1/29/19 - Playing around with the dampening is tricky. at 100, it blows up, and at 50, it dampens too much. It seems like we need a smarter dampening method, after playing around to try to find a goldilocks point, it appears no such point exists. Because reward increases super linearly as you approach 0, you will always increase as you get close, meanwhile, at the high levels, the increased benefit is very small (this should probably change actually. if you have 0 time, having a little bit more time should make a bit different, right?) Regardless, it seems like males need a way to dampen very large values, while boosting very small ones.
1/29/19 - Multiplying by current investment works well (as it makes moving near 0 very sluggish). This also means that near 0 it's basically a random walk. So that will need to be fixed. So males are good at investing relatively little in their females, but they're quite bad at not chasing other females, so it doesn't really look like monogamy. (It works ok with two birds, not at all with 12 birds). By the way, it takes about 5 seconds to run a 1000 x 12 trial, which is not too shabby. I know there is some optimization that could take place if it turns out to be important.
